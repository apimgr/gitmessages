<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{{.Description}}">
    <title>{{.Title}} - {{.ServerTitle}}</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" href="/static/favicon.png">
</head>
<body data-theme="dark">
    {{if .ShowHeader}}
    <header id="main-header">
        <div class="header-container">
            <div class="header-left">
                <button class="mobile-menu-toggle" aria-label="Toggle menu">â˜°</button>
                <a class="logo" href="/">{{.ServerTitle}}</a>
            </div>
            <nav id="main-nav" class="header-center">
                {{if .IsAuthenticated}}
                    {{if .IsAdmin}}
                    <a href="/admin">Admin</a>
                    {{end}}
                    <a href="/user">Dashboard</a>
                {{else}}
                    <a href="/">Home</a>
                {{end}}
            </nav>
            <div class="header-right">
                {{if .IsAuthenticated}}
                <div class="notification-dropdown">
                    <button class="notification-bell" data-count="0" aria-label="Notifications">
                        ðŸ””<span class="notification-badge">0</span>
                    </button>
                </div>
                <div class="profile-dropdown">
                    <button class="profile-toggle" aria-label="Profile menu">
                        <img class="profile-avatar" src="/user/avatar" alt="Avatar">
                        <span class="profile-name">{{.Username}}</span>
                        <span class="caret">â–¼</span>
                    </button>
                    <div class="profile-menu">
                        <a href="/user/profile">Profile</a>
                        <a href="/user/settings">Settings</a>
                        <a href="/user/tokens">API Tokens</a>
                        {{if .IsAdmin}}
                        <hr>
                        <a href="/admin">Admin Panel</a>
                        {{end}}
                        <hr>
                        <a href="/auth/logout">Logout</a>
                    </div>
                </div>
                {{else}}
                <div class="auth-buttons">
                    <a href="/auth/login" class="btn btn-secondary">Login</a>
                    {{if .RegistrationEnabled}}
                    <a href="/auth/register" class="btn btn-primary">Sign Up</a>
                    {{end}}
                </div>
                {{end}}
            </div>
        </div>
    </header>
    {{end}}

    <main id="main-content">
        {{if .Banner}}
        <div class="banner banner-{{.Banner.Type}}">
            <div class="banner-content">
                <span class="banner-icon">{{.Banner.Icon}}</span>
                <span class="banner-message">{{.Banner.Message}}</span>
                {{if .Banner.Action}}
                <a class="banner-action" href="{{.Banner.ActionURL}}">{{.Banner.Action}}</a>
                {{end}}
            </div>
            <button class="banner-dismiss" aria-label="Dismiss">Ã—</button>
        </div>
        {{end}}

        {{template "content" .}}
    </main>

    <footer id="main-footer">
        <div class="footer-container">
            <div class="footer-left">
                <p>&copy; 2025 {{.ServerTitle}}. All rights reserved.</p>
            </div>
            <div class="footer-center">
                <a href="/healthz">Status</a>
                <a href="/api/docs">API Docs</a>
            </div>
            <div class="footer-right">
                <p>Powered by gitmessages</p>
            </div>
        </div>
    </footer>

    <div id="modal-container"></div>
    <div id="toast-container"></div>

    <script src="/static/js/main.js"></script>
    {{if .ExtraJS}}
    <script src="{{.ExtraJS}}"></script>
    {{end}}
</body>
</html>
